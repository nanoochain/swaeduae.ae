<?php<?php

namespace App\Http\Middleware; namespace App\Http\Middleware; use Closure; use Illuminate\Http\Request; use 
Illuminate\Support\Facades\Auth;

class AdminMiddleware { use Closure; public function handle(Request $request, Closure $next) use Illuminate\Http\Request; { use 
Illuminate\Support\Facades\Auth; if (!Auth::check() || !Auth::user()->is_admin) {
            abort(403, 'Unauthorized'); class AdminMiddleware } {
    public function handle(Request $request, Closure $next) return $next($request);
    { }
        if (!Auth::check() || Auth::user()->role !== 'admin') {}
            abort(403, 'Unauthorized');
        }
        return $next($request);
    }
}
